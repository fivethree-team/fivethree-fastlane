# ionic-4-fastlane-plugin

[fastlane plugin](https://rubygems.org/gems/fastlane-plugin-fivethree_ionic) for Ionic 4.

## Table of content

- [Getting started](#getting-started)
- [Actions](#actions)

## Getting started

Install the ionic-4-fastlane plugin

```console
fastlane add_plugin fastlane-plugin-fivethree_ionic
```

This will add `gem 'fastlane-plugin-fivethree_ionic'` in the `fastlane/Pluginfile`.

## Actions

This [Fastfile](./fastlane-plugin-fivethree_ionic/fastlane/Fastfile) contains example of the following actions.

| Action                                                              | Description                                               |
| ------------------------------------------------------------------- | --------------------------------------------------------- |
| [fiv_add_transparent_statusbar](#fiv_add_transparent_statusbar)     |
| [fiv_build_ionic_android](#fiv_build_ionic_android)                 |
| [fiv_android_keystore_action](#fiv_android_keystore_action)         |
| [fiv_build_ionic_android](#fiv_build_ionic_android)                 |
| [fiv_bump_version](#fiv_bump_version)                               |
| [fiv_clean_install](#fiv_clean_install)                             |
| [fiv_increment_build_no](#fiv_increment_build_no)                   |
| [fiv_ionic](#fiv_ionic)                                             | Build your Ionic app for a specific platform              |
| [fiv_select_client](#fiv_select_client)                             | Select a client for white labeling the app                |
| [fiv_select_clients](#fiv_select_clients)                           | Select all, many or one client for white labeling the app |
| [fiv_select_env](#fiv_select_env)                                   | Select an environment folder for white labeling the app   |
| [fiv_sign_android](#fiv_sign_android)                               |
| [fiv_update_version](#fiv_update_version)                           |
| [fiv_update_version_and_build_no](#fiv_update_version_and_build_no) |
| [fiv_version](#fiv_version)                                         |

### fiv_add_transparent_statusbar

### fiv_android_keystore_action

### fiv_build_ionic_android

### fiv_bump_version

### fiv_clean_install

### fiv_increment_build_no

### fiv_ionic

Build your Ionic app for iOS:

```ruby
outputpath = fiv_ionic(
  platform: "ios",
  release: "true",
  prod: "true",
  team_id: "YOUR_TEAM_ID"
)
```

Build your Ionic app for Android:

```ruby
outputpath = fiv_ionic(
  platform: "android",
  release: "true",
  prod: "true"
)
```

#### Options

| Options  | Description                                                                                                                          | Type                                                   | Default    |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------ | ---------- |
| platform | Platform to build on. Can be android, ios or browser                                                                                 | `android` \| `browser` \| `ios`                        |
| prod     | Build for production                                                                                                                 | `true` \| `false`                                      | `false`    |
| release  | Build for release if `true`, or for debug if `false`                                                                                 | `true` \| `false`                                      | `true`     |
| team_id  | The development team (Team ID) to use for code signing                                                                               | `string`                                               |
| type     | This will determine what type of build is generated by Xcode. Valid options are `development`, `enterprise`, `adhoc`, and `appstore` | `development` \| `enterprise` \| `adhoc` \| `appstore` | `appstore` |

### fiv_select_client

Add `fiv_select_client` to your lane to select a client for copying client specific resources before your app build.

For example you have the following app clients:

- clients
  - companyA
    - resources
    - ...
  - companyB
  - companyZ

`fiv_select_client()` lets you select one client and returns the client name.

```ruby
client = fiv_select_client()

# copy client resources e.g. "cp ../clients/#{client}/resources ../"
# build app
```

#### CI

Client selection can also be passed as an option for a non interactive environment. Add the option `client` to `before_all` and assign it to an environment variable `CLIENT`.

```ruby
before_all do |lane, options|
  ENV["CLIENT"] = options[:client]
end
```

`fastlane example_lane client:companyA`

#### Options

| Options        | Description                                | Type     | Default   |
| -------------- | ------------------------------------------ | -------- | --------- |
| clients_folder | Path to your clients white label resources | `string` | `clients` |

### fiv_select_clients

Add `fiv_select_clients` to your lane to select all, many or one client for copying client specific resources before your app build in a loop.

For example you have the following app clients:

- clients
  - companyA
    - resources
    - ...
  - companyB
  - companyZ

`fiv_select_clients()` lets you select all, many or one client and returns an array of client names.

```ruby
clients = fiv_select_clients()

clients.each do |client|
  # copy client resources e.g. "cp ../clients/#{client}/resources ../"
  # build app
end
```

#### CI

Clients selection can also be passed as an option for a non interactive environment. Add the option `clients` to `before_all` and assign it to an environment variable `CLIENTS`.

```ruby
before_all do |lane, options|
  ENV["CLIENTS"] = options[:clients]
end
```

Seperate clients by `,`:

`fastlane example_lane clients:companyA,companyB`

#### Options

| Options        | Description                                | Type     | Default   |
| -------------- | ------------------------------------------ | -------- | --------- |
| clients_folder | Path to your clients white label resources | `string` | `clients` |

### fiv_select_env

Add `fiv_select_env` to your lane to select an environment of a client for copying specific resources for this environment before your app build. e.g the resources or app icon and splash screen might differ for each environment.

For example you have the following app clients with different environments:

- clients
  - companyA
    - resources
    - environment
      - prod
        - resources
      - qa
        - resources
      - test
        - resorces
  - companyB
  - companyZ

`fiv_select_env()` lets you select one client and returns the client name.

```ruby
client = fiv_select_client()
env = fiv_select_env(client: client)

# copy client resources from environment e.g. "cp ../clients/#{client}/enviroment/#{env}/resources ../"
# build app
```

#### CI

Environment selection can also be passed as an option for a non interactive environment. Add the option `env` to `before_all` and assign it to an environment variable `ENV`.

```ruby
before_all do |lane, options|
  ENV["CLIENT"] = options[:client]
  ENV["ENV"] = options[:env]
end
```

`fastlane example_lane client:companyA env:prod`

### fiv_sign_android

```ruby
fiv_sign_android(
  output_directory: "OUTPUT_DIR",
  keystore_name: "KEYSTORE_NAME",
  alias: "KEYSTORE_ALIAS",
  version: "APP_VERSION",
  build_no: "BUILD_NO",
  silent: true
)
```

### fiv_update_version

### fiv_update_version_and_build_no

### fiv_version
